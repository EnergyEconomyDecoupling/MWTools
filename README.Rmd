---
output: github_document
---

<!-- README.md is generated from README.Rmd. Please edit that file -->

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.path = "man/figures/README-",
  out.width = "100%"
)
```

# MWTools

<!-- badges: start -->

[![Codecov test coverage](https://codecov.io/gh/EnergyEconomyDecoupling/MWTools/branch/master/graph/badge.svg)](https://codecov.io/gh/EnergyEconomyDecoupling/MWTools?branch=master)
<!-- badges: end -->

The `R` package `MWTools` provides functions for the estimation of human and animal muscle work for use in Societal Exergy Analysis (SEA), and using the Physical Supply Use Table (PSUT) framework.

## Installation

You can install the development version from [GitHub](https://github.com/) with:

``` r
# install.packages("devtools")
devtools::install_github("EnergyEconomyDecoupling/MWTools")
```

## Animal Muscle Work

Raw data for the estimation of animal muscle work is obtained from the Food and Agriculture Organisation of the United Nations Statistical Database (FAOSTAT), via the `R` package `FAOSTAT`. The `MWTools` package provides a wrapper function for downloading data for the number of live animals, `down_fao_live_animals`, which utilises the function `FAOSTAT::get_faostat_bulk()`. Once downloaded `MWTools` provides a number of functions for the calculation of the number of working animals by species, country, year and in agriculture, transport, and in total.

The helper function `calc_amw_pfu` returns a tidy data frame containing data for the primary, final, and useful energy by species, country, year and in agriculture, transport, and in total.

```{r get_example_data}
library(MWTools)

fao_fp <- file.path("C:/Users/Zeke Marshall/Dropbox/Fellowship 1960-2015 PFU database",
                    "Data/Muscle Work - Data",
                    "fao_qcl_data.rds")

fao_raw_rds <- readr::read_rds(file = fao_fp)

amw_pfu_data <- calc_amw_pfu(.df = fao_raw_rds)

head(amw_pfu_data)

```

Use the `plot_amw_summary` function to produce a plot summarising the animal muscle work data for a particular country and sector.

```{r amw_plot, echo=TRUE, fig.height=6, fig.width=7}

plot_amw_summary(amw_pfu_df = amw_pfu_data,
                 amw_numbers_df = amw_numbers_df,
                 country = "CHN",
                 sector = "Agriculture")

```

## Human Muscle Work

Raw data for the estimation of human muscle work is obtained from the International Labor Organisation (ILO), via the `R` package `Rilostat`. The `MWTools` package includes bundled ILO data for the number of employed persons by sector and mean number of working hours by sector.

Using data for the number of employed persons and mean yearly working hours the primary, final, and useful energy associated with human muscle work can be estimated using the helper function `MWTools::calc_hmw_pfu`.

``` {r hmw_pfu}

ilo_fp <- file.path("C:/Users/Zeke Marshall/Dropbox/Fellowship 1960-2015 PFU database",
                    "Data/Muscle Work - Data",
                    "ilo_hmw_data.rds")

ilo_raw_rds <- readr::read_rds(file = ilo_fp)

hmw_pfu_data <- calc_hmw_pfu(.df = ilo_raw_rds)

head(hmw_pfu_data)

```

Use the `plot_hmw_summary` function to produce a plot summarising the human muscle work data for a particular country and sector.

```{r hmw_plot, echo=TRUE, fig.height=6, fig.width=7}

plot_hmw_summary(hmw_pfu_df = hmw_pfu_data,
                 country = "USA",
                 sector = "Agriculture")

```
Lastly....
